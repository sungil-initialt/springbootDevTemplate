<!DOCTYPE html>
<!-- Default Layout Import-->
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/common/layout/defaultLayout}"
      layout:fragment="Content"
>
<head>
    <title>Fetch í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <!-- inline CSS ì˜ì—­-->
    <style th:inline="css" type="text/css">
        .base-div {
            background-color: #f0f8ff;
            padding: 10px;
            border-radius: 10px;
            line-height: 1.6;
            font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            font-weight: 350;
        }
        .inner-div {
            background-color: #F9F0FFFF;
            padding: 5px;
            border-radius: 5px;
            margin: 16px 0;
            font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            font-weight: 400;
        }
        .btn-normal {
            background-color: #e9ecef;
            color: #212529;
            border: 1px solid #ced4da;
            padding: 2px 8px;
            font-size: 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .btn-normal:hover {
            background-color: #e3e7ea; /* ì•„ì£¼ ë¯¸ë¬˜í•˜ê²Œ ë°ê¸° ì¡°ì • */
        }

        .btn-normal:active {
            background-color: #dfe3e6;
        }

        .btn-normal:disabled {
            background-color: #f1f3f5;
            color: #adb5bd;
            cursor: not-allowed;
        }
    </style>

    <!-- inline JS ì˜ì—­-->
    <script type="module" th:inline="javascript">
        import { requestFetch, rsaEncrypt } from [[@{/js/_framework/frameworkUtil.js}]];
        window.requestFetch = requestFetch;
    </script>
</head>
<body>
<div class="inner-div">
    ğŸ”” ì‹œìŠ¤í…œ ì—ì„œ ê¸°ë³¸ ì œê³µ í•˜ëŠ” ì—ëŸ¬ í˜ì´ì§€ ê°€ì´ë“œ ì…ë‹ˆë‹¤<br>
    400, 401, 403, 404, 405, 500 ì¼€ì´ìŠ¤ì— ê°ê°ì˜ ì—ëŸ¬ í˜ì´ì§€ë¥¼ ì œê³µí•˜ë©° http ìƒíƒœ ì½”ë“œë„ ê·¸ì— ë”°ë¼ ì œê³µ í•©ë‹ˆë‹¤.
</div>

<div class="base-div">
    <label>ğŸŸ¢ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” URL (GET /xxx) :</label>
    <button class="btn-normal" id="notExist">404 Not Exist URL</button>
    <script>
        document.getElementById('notExist').addEventListener('click', function () {
            const url = '/xxx'; // ì›í•˜ëŠ” ë§í¬ë¡œ ìˆ˜ì • ê°€ëŠ¥
            window.location.href = url; // ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ URLë¡œ ì´ë™
        });
    </script><br><br>

    <label>ğŸŸ¢ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” Request Method (POST /index) :</label>
    <button class="btn-normal" id="notSupportMethod">405 Not Support Method</button>
    <script>
        document.getElementById('notSupportMethod').addEventListener('click', function () {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '/index'; // ì—¬ê¸°ì— ì›í•˜ëŠ” URL ì§€ì •
            document.body.appendChild(form);
            form.submit();
        });
    </script><br><br>

    <label>ğŸŸ¢ Runtime Exception (GET /runtimeException) :</label>
    <button class="btn-normal" id="runtimeException">500 Runtime Exception</button>
    <script>
        document.getElementById('runtimeException').addEventListener('click', function () {
            const url = '/runtimeException'; // ì›í•˜ëŠ” ë§í¬ë¡œ ìˆ˜ì • ê°€ëŠ¥
            window.location.href = url; // ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ URLë¡œ ì´ë™
        });
    </script><br><br>

    <label>ğŸŸ¢ Service Exception (GET /serviceException) :</label>
    <button class="btn-normal" id="serviceException">400 Service Exception</button>
    <script>
        document.getElementById('serviceException').addEventListener('click', function () {
            const url = '/serviceException'; // ì›í•˜ëŠ” ë§í¬ë¡œ ìˆ˜ì • ê°€ëŠ¥
            window.location.href = url; // ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ URLë¡œ ì´ë™
        });
    </script><br><br>

    <label>ğŸŸ¢ Authentication Exception (GET /authException) :</label>
    <button class="btn-normal" id="authException">401/403 Authentication Exception</button>
    <script>
        document.getElementById('authException').addEventListener('click', function () {
            const url = '/authException'; // ì›í•˜ëŠ” ë§í¬ë¡œ ìˆ˜ì • ê°€ëŠ¥
            window.location.href = url; // ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ URLë¡œ ì´ë™
        });
    </script><br><br>

    <div class="inner-div">
        ğŸ’¡ í”„ë¡œíŒŒì¼ì— ë”°ë¼ ignoreCustomErrorViewForDebug: true ë¥¼ ì ìš© í•˜ì—¬ ë””ë²„ê¹…ìš© ì—ëŸ¬ í˜ì´ì§€ë¡œ ì „í™˜ ê°€ëŠ¥ í•©ë‹ˆë‹¤.<br>
    </div>






</div>
<div class="inner-div">
    abc
</div>
<br>

<div class="base-div">
    <label>async :</label> <button id="deDuplication1">deDuplication</button>
    <script>
        document.getElementById('deDuplication1').addEventListener('click', async function() {
            try {
                const data = await requestFetch('/duplicatedRequest', {
                    useTimestamp: true,
                });
                console.log('response:', typeof data === 'string' ? data : JSON.stringify(data, null, 2));
            } catch (error) {
                console.error("Error requestFetch:", error);
            }
        });
    </script>
</div>
<br>

<div class="base-div">
    <label>sync :</label> <button id="deDuplication2">deDuplication</button>
    <script>
        document.getElementById('deDuplication2').addEventListener('click', async function() {
            try {
                const data = await requestFetch('/duplicatedRequest', {
                });
                console.log('response:', typeof data === 'string' ? data : JSON.stringify(data, null, 2));
            } catch (error) {
                console.error("Error requestFetch:", error);
            }
        });
    </script>
</div>
<br>


<div class="base-div">
    <label>plainText for RSA :</label> <input type="text" id="plainText" placeholder="Enter Confidential Information" style="width: 400px;"/>
    <button id="encrypt">Encrypt</button>
    <br><br>
    <label>rsa Encrypted :</label> <input type="text" id="rsaEncryptText" style="width: 400px;"/>
    <button id="sendForRsa">send to server</button>
    <script>
        document.getElementById('encrypt').addEventListener('click', async function () {
            try {
                const plainText = document.getElementById('plainText').value;
                if (!plainText) {
                    alert(" PlainText is required");
                    return;
                }
                const encryptedData = await rsaEncrypt(plainText);
                document.getElementById('rsaEncryptText').value = encryptedData;
            } catch (error) {
                console.error('Error rsaEncrypt:', error);
            }
        });

        document.getElementById('sendForRsa').addEventListener('click', async function() {
            try {
                const data = await requestFetch('/decryptRsa', {
                    method: 'POST',
                    body: document.getElementById('rsaEncryptText').value
                });
                console.log('response:', typeof data === 'string' ? data : JSON.stringify(data, null, 2));
            } catch (error) {
                console.error("Error requestFetch:", error);
            }
        });
    </script>
</div>
<br>

<!--<div>-->
<!--    <button id="btn3">httpCache(async)</button>-->
<!--    <script>-->
<!--        document.getElementById('btn3').addEventListener('click', function() {-->
<!--            const apiUrl = host + 'httpCache'; // ì‹¤ì œ API ì£¼ì†Œë¡œ ë³€ê²½ í•„ìš”-->

<!--            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ Last-Modified ê°’ì„ ê°€ì ¸ì˜´-->
<!--            let lastModified = localStorage.getItem("lastModified");-->

<!--            // ìš”ì²­ í—¤ë” ì„¤ì •-->
<!--            const headers = {};-->

<!--            // ì´ì „ ìš”ì²­ì—ì„œ ë°›ì€ Last-Modified ê°’ì´ ìˆë‹¤ë©´ If-Modified-Since ì¶”ê°€-->
<!--            if (lastModified) {-->
<!--                headers["If-Modified-Since"] = lastModified;-->
<!--            }-->

<!--            // Fetch ìš”ì²­ ì„¤ì •-->
<!--            const options = {-->
<!--                method: 'GET',-->
<!--                headers: headers, // ë™ì ìœ¼ë¡œ ì„¤ì •ëœ í—¤ë” ì‚¬ìš©-->
<!--                cache: "default", // ë¸Œë¼ìš°ì € ìºì‹œ ì •ì±… ì‚¬ìš©-->
<!--            };-->

<!--            fetch(apiUrl, options)-->
<!--                .then(response => {-->
<!--                    // ì‘ë‹µì´ 200 OKì¸ ê²½ìš°: ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ë°›ì•„ì„œ ìºì‹œ ì—…ë°ì´íŠ¸-->
<!--                    if (response.status === 200) {-->
<!--                        const newLastModified = response.headers.get("Last-Modified");-->
<!--                        if (newLastModified) {-->
<!--                            localStorage.setItem("lastModified", newLastModified);-->
<!--                        }-->
<!--                        return response.json(); // JSON ë°ì´í„° ë°˜í™˜-->
<!--                    }-->
<!--                    // ì‘ë‹µì´ 304 Not Modifiedì¸ ê²½ìš°: ê¸°ì¡´ ìºì‹œëœ ë°ì´í„° ì‚¬ìš©-->
<!--                    else if (response.status === 304) {-->
<!--                        console.log("304 Not Modified: Using cached data.");-->
<!--                        return Promise.resolve(null);-->
<!--                    }-->
<!--                })-->
<!--                .then(data => {-->
<!--                    if (data) {-->
<!--                        console.log("Received Data:", data);-->
<!--                    } else {-->
<!--                        console.log("Using Cached Data.");-->
<!--                    }-->
<!--                })-->
<!--                .catch(error => console.error('Error:', error));-->
<!--        });-->
<!--    </script>-->
<!--</div>-->
</body>
</html>